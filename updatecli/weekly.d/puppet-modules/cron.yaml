---
title: Bump the Cron Puppet Module

scms:
  default:
    kind: github
    spec:
      user: "{{ .github.user }}"
      email: "{{ .github.email }}"
      owner: "{{ .github.owner }}"
      repository: "{{ .github.repository }}"
      token: "{{ requiredEnv .github.token }}"
      username: "{{ .github.username }}"
      branch: "{{ .github.branch }}"

sources:
  latestVersion:
    kind: githubrelease
    name: Get the latest puppetlab/cron module version
    spec:
      owner: voxpupuli
      repository: puppet-cron
      token: "{{ requiredEnv .github.token }}"
      username: "{{ .github.username }}"
      versionfilter:
        kind: semver

conditions:
  testPuppetModuleExists:
    kind: shell
    disablesourceinput: true
    spec:
      command: curl --verbose --silent --show-error --location --fail --head --output /dev/null https://forge.puppet.com/v3/files/puppet-cron-{{ source "latestVersion" }}.tar.gz

targets:
  puppetfile:
    name: "Update Puppetfile with the latest Cron module version"
    kind: file
    sourceid: latestVersion
    spec:
      file: Puppetfile
      matchpattern: >
        mod 'puppetlabs-cron'(.*)
      replacepattern: >
        mod 'puppetlabs-cron', '{{ source "latestVersion" }}'
#     scmid: default

# pullrequests:
#   default:
#     kind: github
#     scmid: default
#     targets:
#       - puppetfile
#     spec:
#       labels:
#         - puppet-module
#         - dependencies
